<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usuários e Autenticação - Trace Point API</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo"><h1>Trace Point API</h1></div>
        <button class="hamburger-menu" id="hamburgerMenu" aria-label="Toggle navigation" aria-expanded="false">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>
        <div class="nav-links" id="navLinks">
            <div class="sidebar-header">
                <h1>Trace Point API</h1>
            </div>
            <ul>
                <li><a href="index.html">Visão Geral</a></li>
                <li><a href="instalacao.html">Instalação</a></li>
                <li><a href="autenticacao_usuarios.html" class="active">Usuários & Acesso</a></li>
                <li><a href="api_referencia.html">API Referência</a></li>
                <li><a href="estrutura_projeto.html">Estrutura do Projeto</a></li> 
                <li><a href="dependencias_tecnologias.html">Dependências</a></li>
                <li><a href="modelo_relacional.html">Modelo Relacional</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <header class="page-header">
            <h1 class="project-title">Níveis de Acesso, Autenticação e Usuários</h1>
        </header>

        <section id="niveis-acesso">
            <h2><span class="section-number">6.</span> Níveis de Acesso e Autenticação</h2>
            <p>A autenticação na API é realizada via JSON Web Tokens (JWT), enviados no cabeçalho <code>Authorization</code> como <code>Bearer Token</code>.</p>
            <p>Existem os seguintes níveis de acesso:</p>
            <ul>
                <li><strong>Visitor:</strong> Acesso básico, permitindo visualização de informações e agendamento de visitas.</li>
                <li><strong>Organizer:</strong> Além das permissões de Visitor, pode criar e gerenciar seus próprios eventos e locais.</li>
                <li><strong>Admin:</strong> Acesso total a todas as funcionalidades da API, incluindo gerenciamento de todos os dados e usuários.</li>
                <li><strong>Público:</strong> Rotas que não requerem autenticação, como login e registro de novos usuários. </li>
            </ul>
        </section>

        <hr class="section-divider">

        <section id="criacao-usuarios">
            <h2><span class="section-number">6.1.</span> Criação de Usuários</h2>
            
            <h3>Usuário Administrador Padrão (Admin)</h3>
            <p>Para facilitar o primeiro acesso e a configuração inicial, um usuário administrador padrão é <strong>automaticamente criado no banco de dados</strong> quando as migrações do projeto são executadas. Esta criação é realizada por um script de "seed" dentro de uma das migrações (por exemplo, um arquivo como <code>CreateDefaultAdminUserSeed.ts</code>).</p>
            <p>Este usuário padrão possui as seguintes credenciais iniciais:</p>
            <ul>
                <li><strong>Email para login:</strong> <code>admin@example.com</code></li>
                <li><strong>Senha para login:</strong> <code>admin123</code></li>
                <li><strong>Nível de acesso (Role):</strong> <code>admin</code></li>
                <li><strong>ID do Usuário (UUID):</strong> <code>9dfce170-5094-436f-9413-f5afc769a75e</code></li>
                <li><strong>Foto de Perfil (URL):</strong> <a href="https://l1nq.com/icone-de-perfil-de-avatar-padrao" target="_blank" rel="noopener noreferrer">https://l1nq.com/icone-de-perfil-de-avatar-padrao</a></li>
            </ul>
            <p>Com este usuário, você pode acessar imediatamente todas as funcionalidades administrativas da API após a configuração inicial e execução das migrações do banco de dados.</p>
            <p>O processo de criação na migração utiliza um comando SQL similar a este:</p>
            <pre><code>-- SQL executado pela migração para criar o admin padrão:
INSERT INTO "user" (
  id, name, profile_pick, role, email, "password"
) VALUES (
  '9dfce170-5094-436f-9413-f5afc769a75e',
  'Admin User',
  'https://l1nq.com/icone-de-perfil-de-avatar-padrao',
  'admin',
  'admin@example.com',
  '$2b$10$yG9D2ihkLL6hTh5KCw/l5.BqAqJ3i49GIvksxCBStGSMEJtTHS2ey' -- Senha hasheada para: admin123
);</code></pre>
            <p><strong>Importante:</strong> Por questões de segurança, é <strong>altamente recomendável</strong> que você altere a senha deste usuário padrão assim que possível após o primeiro login, especialmente se estiver configurando um ambiente de homologação ou produção.</p>

            <h4>Como Alterar a Senha do Administrador Padrão (via SQL)</h4>
            <p>Se você precisar alterar a senha do usuário administrador padrão diretamente no banco de dados (por exemplo, se esqueceu a senha ou para maior segurança), você precisará gerar um novo hash bcrypt para a nova senha e então atualizar o campo <code>password</code> na tabela <code>user</code>.</p>
            <p><strong>Passo 1: Gerar o Hash da Nova Senha</strong></p>
            <p>Você pode usar uma ferramenta online de geração de <a href="https://bcrypt-generator.com/" target="_blank" rel="noopener noreferrer">hash bcrypt</a> com Rounds de 10, ou um script simples em Node.js com a biblioteca <code>bcrypt</code> para gerar o hash da sua nova senha. Por exemplo, para a senha "novaSenhaAdminSuperSegura":</p>
            <pre><code>// Exemplo de script Node.js para gerar hash (não execute na documentação, apenas para ilustração)
// const bcrypt = require('bcrypt');
// const saltRounds = 10;
// const minhaNovaSenha = 'novaSenhaAdminSuperSegura';
// bcrypt.hash(minhaNovaSenha, saltRounds, function(err, hash) {
//     console.log('Seu novo hash bcrypt é: ', hash);
// });
// Resultado exemplo: $2b$10$ExemploDeNovoHashGeradoPeloBcryptAqui123</code></pre>
            <p><strong>Passo 2: Atualizar a Senha no Banco de Dados</strong></p>
            <p>Com o novo hash gerado (vamos supor que seja <code>$2b$10$SeuNovoHashSuperSeguroAquiXxYyZz</code>), execute o seguinte comando SQL no seu banco de dados PostgreSQL para atualizar a senha do admin padrão (ID: <code>9dfce170-5094-436f-9413-f5afc769a75e</code>):</p>
            <pre><code>UPDATE "user"
SET "password" = '$2b$10$SeuNovoHashSuperSeguroAquiXxYyZz' -- Substitua pelo seu novo hash gerado
WHERE id = '9dfce170-5094-436f-9413-f5afc769a75e';</code></pre>
            <p>Você também pode usar este método para atualizar outros campos como <code>name</code> ou <code>profile_pick</code> se necessário, mas para alterações de senha, o hashing é crucial.</p>
            <p><em>Lembre-se: Nunca armazene senhas em texto plano no banco de dados. Sempre use hashes seguros como Bcrypt.</em></p>


            <h3>Visitor / Organizer</h3>
            <p>Visitantes e Organizadores podem se registrar de forma independente através do endpoint público da API:</p>
            <pre><code>POST /user/register
Content-Type: application/json

{
  "name": "Nome do Usuário",
  "userLogin": { 
    "email": "usuario@example.com", 
    "password": "senhaSegura123" 
  },
  "profilePick": "https://example.com/foto.jpg",
  "role": "visitor"  // ou "organizer"
}</code></pre>
            <p>Este endpoint permite que novos usuários criem suas contas e comecem a interagir com a plataforma de acordo com o papel (<code>role</code>) especificado.</p>
        </section>

        <hr class="section-divider">

        <section id="navegacao">
            <p style="text-align: center; margin-top: 25px;">
                <a href="index.html" class="button-link">Voltar para Visão Geral</a>
                <a href="api_referencia.html" class="button-link">Referência da API</a>
                <a href="instalacao.html" class="button-link">Guia de Instalação</a>
            </p>
        </section>

        <footer>
            <p>Trace Point API &copy; 2025</p>
            <p><a href="https://github.com/vyctor-carvalho/Trace_Point" target="_blank" rel="noopener noreferrer">Ver Projeto no GitHub</a></p>
        </footer>
    </div>
    <script src="script.js" defer></script> 
</body>
</html>