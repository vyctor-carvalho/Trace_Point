<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trace Point API - DocumentaÃ§Ã£o</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <h1>Trace Point - API Backend</h1>
    </nav>

    <div class="container">
        <header>
            <h1>API Trace Point</h1>
            <p class="subtitle">API RESTful para organizaÃ§Ã£o de visitas durante a COP-30 em BelÃ©m. Permite o registro de usuÃ¡rios (admin, visitor, organizer), eventos, locais visitados e agendamentos.</p>
        </header>

        <section id="tecnologias">
            <h2>Tecnologias Utilizadas</h2>
            <ul class="tech-list">
                <li>Node.js 18</li>
                <li>TypeScript</li>
                <li>PostgreSQL</li>
                <li>TypeORM</li>
                <li>Docker + Docker Compose</li>
                <li>pgAdmin (interface de banco)</li>
            </ul>
        </section>

        <section id="instalacao">
            <h2>ConfiguraÃ§Ã£o e InstalaÃ§Ã£o</h2>

            <h3>Requisitos</h3>
            <h4>Para rodar com Docker:</h4>
            <ul>
                <li>Docker</li>
                <li>Docker Compose</li>
            </ul>
            <h4>Para rodar manualmente:</h4>
            <ul>
                <li>Node.js 18+</li>
                <li>PostgreSQL</li>
                <li>NPM</li>
            </ul>

            <h3>1. Clone o repositÃ³rio</h3>
            <pre><code>git clone https://github.com/vyctor-carvalho/Trace_Point.git
cd Trace_Point</code></pre>

            <h3>Rodando com Docker</h3>
            <h4>2. Copie o arquivo `.env`</h4>
            <pre><code>cp .env.copy .env</code></pre>
            <p>Edite as variÃ¡veis conforme necessÃ¡rio. Para uso com Docker, mantenha:</p>
            <pre><code>DB_HOST=db
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=tracepoint</code></pre>
            <h4>3. Suba os containers</h4>
            <pre><code>docker-compose up --build</code></pre>
            <h4>4. Acessar o banco de dados via pgAdmin</h4>
            <p>Abra o <strong>pgAdmin</strong> em: <code>http://localhost:8080</code> (Conforme seu README mais recente. Ajuste se o seu pgAdmin estiver em outra porta, como 5050, que Ã© um padrÃ£o comum para o container pgAdmin).</p>
            <p>Na interface do pgAdmin, adicione uma nova conexÃ£o com os seguintes dados:</p>
            <ul>
                <li><strong>Name</strong>: <code>tracepoint-db</code> (ou qualquer nome)</li>
                <li><strong>Host name/address</strong>: <code>db</code></li>
                <li><strong>Port</strong>: <code>5432</code></li>
                <li><strong>Username</strong>: <code>postgres</code></li>
                <li><strong>Password</strong>: <code>postgres</code></li>
            </ul>
            <p>ApÃ³s conectar, selecione o banco de dados <code>tracepoint</code>.</p>

            <h3>Rodando Manualmente</h3>
            <h4>1. Instale as dependÃªncias</h4>
            <pre><code>npm install</code></pre>
            <h4>2. Configure o <code>.env</code> com seu PostgreSQL local</h4>
            <pre><code># ConfiguraÃ§Ãµes do servidor
SYSTEM_API_PORT=sua_porta_pra_api

# Dados do banco
DB_HOST=localhost # ou seu host local
DB_USER=postgres
DB_PORT=sua_porta_do_postgres # ex: 5432
DB_PASSWORD=sua_senha_do_postgres
DB_NAME=nome_do_banco # ex: tracepoint

# JWT
JWT_SECRET=sua_chave_secreta_forte
REFRESH_SECRET=sua_outra_chave_secreta_forte
JWT_EXPIRES_IN=3600
REFRSH_TOKEN_EXPIRES_IN=604800</code></pre>
            <h4>3. Rode as migrations</h4>
            <pre><code>npm run migration:run</code></pre>
            <h4>4. Inicie o servidor</h4>
            <pre><code>npm run dev</code></pre>
        </section>

        <section id="niveis-acesso">
            <h2>NÃ­veis de Acesso</h2>
            <p>A API utiliza trÃªs nÃ­veis de acesso para proteger suas rotas:</p>
            <ul>
                <li><strong>Visitor</strong>: UsuÃ¡rio autenticado com permissÃµes bÃ¡sicas, como visualizar eventos, locais e agendar visitas.</li>
                <li><strong>Organizer</strong>: UsuÃ¡rio autenticado com permissÃµes de Visitor, alÃ©m da capacidade de criar e gerenciar eventos e locais que criou.</li>
                <li><strong>Admin</strong>: UsuÃ¡rio autenticado com acesso total a todas as funcionalidades da API, incluindo gerenciamento de usuÃ¡rios.</li>
                <li><strong>PÃºblico</strong>: Rotas que nÃ£o exigem autenticaÃ§Ã£o.</li>
            </ul>
            <p>As rotas protegidas por JWT exigem um token de acesso vÃ¡lido no cabeÃ§alho <code>Authorization</code> (ex: <code>Bearer seu_token_jwt</code>).</p>
        </section>

        <section id="criacao-usuarios">
            <h2>CriaÃ§Ã£o de UsuÃ¡rios</h2>
            <h3>Admin (somente via SQL):</h3>
            <pre><code>INSERT INTO "user" (
  id, name, profile_pick, role, email, "password"
) VALUES (
  '9dfce170-5094-436f-9413-f5afc769a75e',
  'Admin User',
  'https://example.com/avatar.png',
  'admin',
  'admin@example.com',
  '$2b$10$yG9D2ihkLL6hTh5KCw/l5.BqAqJ3i49GIvksxCBStGSMEJtTHS2ey' -- Senha: admin123
);</code></pre>
            <p><em>ObservaÃ§Ã£o: No seu README, a URL da imagem do admin estava formatada como um link Markdown dentro do SQL. Aqui foi simplificado para a URL direta.</em></p>

            <h3>Visitor ou Organizer (POST <code>/user/register</code>):</h3>
            <p>Endpoint pÃºblico para registro de novos usuÃ¡rios.</p>
            <pre><code>{
  "name": "Nome do usuÃ¡rio",
  "userLogin": {
    "email": "email@example.com",
    "password": "senha123"
  },
  "profilePick": "https://example.com/foto.jpg",
  "role": "visitor" // ou "organizer"
}</code></pre>
        </section>

        <section id="rotas-api">
            <h2>Rotas da API</h2>
            <p>A seguir, uma visÃ£o geral dos principais grupos de rotas da API.</p>

            <h3>AutenticaÃ§Ã£o (<code>/auth</code>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>MÃ©todo</th>
                        <th>Rota</th>
                        <th>ProteÃ§Ã£o JWT</th>
                        <th>NÃ­vel de Acesso</th>
                        <th>DescriÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/auth/login</code></td>
                        <td>NÃ£o</td>
                        <td>PÃºblico</td>
                        <td>Realiza o login do usuÃ¡rio.</td>
                    </tr>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/auth/refresh</code></td>
                        <td>NÃ£o</td>
                        <td>PÃºblico</td>
                        <td>Atualiza o token de acesso.</td>
                    </tr>
                </tbody>
            </table>

            <h3>UsuÃ¡rios (<code>/user</code>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>MÃ©todo</th>
                        <th>Rota</th>
                        <th>ProteÃ§Ã£o JWT</th>
                        <th>NÃ­vel de Acesso</th>
                        <th>DescriÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/user/register</code></td>
                        <td>NÃ£o</td>
                        <td>PÃºblico</td>
                        <td>Registra um novo usuÃ¡rio (visitor ou organizer).</td>
                    </tr>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/user/booking</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Agenda uma visita a um evento para um usuÃ¡rio.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/user/</code></td>
                        <td>Sim</td>
                        <td>Admin</td>
                        <td>Lista todos os usuÃ¡rios.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/user/:id</code></td>
                        <td>Sim</td>
                        <td>Admin</td>
                        <td>Busca um usuÃ¡rio especÃ­fico pelo ID.</td>
                    </tr>
                    <tr>
                        <td><code>PUT</code></td>
                        <td><code>/user/:id</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Atualiza dados de um usuÃ¡rio (usuÃ¡rio atualiza o prÃ³prio, admin qualquer).</td>
                    </tr>
                    <tr>
                        <td><code>DELETE</code></td>
                        <td><code>/user/:id</code></td>
                        <td>Sim</td>
                        <td>Admin</td>
                        <td>Deleta um usuÃ¡rio especÃ­fico pelo ID.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Locais (<code>/place</code>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>MÃ©todo</th>
                        <th>Rota</th>
                        <th>ProteÃ§Ã£o JWT</th>
                        <th>NÃ­vel de Acesso</th>
                        <th>DescriÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/place/</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Cria um novo local.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/place/</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Lista todos os locais.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/place/:id</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Busca um local especÃ­fico pelo ID.</td>
                    </tr>
                    <tr>
                        <td><code>PUT</code></td>
                        <td><code>/place/:id</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Atualiza um local especÃ­fico pelo ID.</td>
                    </tr>
                    <tr>
                        <td><code>DELETE</code></td>
                        <td><code>/place/:id</code></td>
                        <td>Sim</td>
                        <td>Admin</td>
                        <td>Deleta um local especÃ­fico pelo ID.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Eventos (<code>/event</code>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>MÃ©todo</th>
                        <th>Rota</th>
                        <th>ProteÃ§Ã£o JWT</th>
                        <th>NÃ­vel de Acesso</th>
                        <th>DescriÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/event/</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Cria um novo evento.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/event/</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Lista todos os eventos.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/event/:id</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Busca um evento especÃ­fico pelo ID.</td>
                    </tr>
                    <tr>
                        <td><code>PUT</code></td>
                        <td><code>/event/:id</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Atualiza um evento especÃ­fico pelo ID.</td>
                    </tr>
                    <tr>
                        <td><code>DELETE</code></td>
                        <td><code>/event/:id</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Deleta um evento especÃ­fico pelo ID.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Visitas Realizadas (<code>/visited</code>)</h3>
            <table>
                <thead>
                    <tr>
                        <th>MÃ©todo</th>
                        <th>Rota</th>
                        <th>ProteÃ§Ã£o JWT</th>
                        <th>NÃ­vel de Acesso</th>
                        <th>DescriÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>POST</code></td>
                        <td><code>/visited/</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Registra uma visita a um local.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/visited/</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Lista todos os registros de visitas (admins veem todos, outros os seus).</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/visited/user/:userId</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Lista visitas por ID de usuÃ¡rio.</td>
                    </tr>
                    <tr>
                        <td><code>GET</code></td>
                        <td><code>/visited/place/:placeId</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Lista visitas por ID de local.</td>
                    </tr>
                    <tr>
                        <td><code>PUT</code></td>
                        <td><code>/visited/</code></td>
                        <td>Sim</td>
                        <td>Visitor, Organizer, Admin</td>
                        <td>Atualiza um registro de visita.</td>
                    </tr>
                    <tr>
                        <td><code>DELETE</code></td>
                        <td><code>/visited/</code></td>
                        <td>Sim</td>
                        <td>Organizer, Admin</td>
                        <td>Deleta um registro de visita (body: userId, placeId).</td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <section id="exemplos-requisicoes">
            <h2>Exemplos de RequisiÃ§Ãµes (Corpo)</h2>
            <p>Para detalhes completos e mais exemplos, consulte o README no GitHub.</p>

            <h3>Criar local (<code>POST /place</code>)</h3>
            <p><em>Acesso: Organizer, Admin</em></p>
            <pre><code>{
  "name": "EstaÃ§Ã£o das Docas",
  "type": "cultural",
  "address": {
    "postalColde": "66010-020", 
    "street": "Av. Boulevard Castilhos FranÃ§a",
    "numberHouse": 600,
    "complement": "ArmazÃ©m 2"
  }
}</code></pre>

            <h3>Criar evento (<code>POST /event</code>)</h3>
            <p><em>Acesso: Organizer, Admin</em></p>
            <pre><code>{
  "title": "Tour COP-30",
  "eventDate": "2025-07-15T14:00:00.000Z",
  "description": "Tour pelo centro histÃ³rico de BelÃ©m.",
  "place": "UUID-do-place"
}</code></pre>
        </section>

        <section id="estrutura-projeto">
            <h2>Estrutura do Projeto</h2>
            <p>A estrutura de pastas e arquivos principais do projeto Ã© a seguinte:</p>
            <pre><code>ğŸ“ raiz/
â”‚
â”œâ”€â”€ .env               # VariÃ¡veis reais
â”œâ”€â”€ .env.copy          # Modelo para configuraÃ§Ã£o
â”œâ”€â”€ .dockerignore      # Ignora arquivos do Docker
â”œâ”€â”€ docker-compose.yml # Arquitetura dos containers
â”œâ”€â”€ Dockerfile         # Imagem do app
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ README.md
â”œâ”€â”€ index.ts
â”œâ”€â”€ server.ts
â”‚
â””â”€â”€ src/
    â”‚
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ EsportEnv.ts
    â”‚
    â”œâ”€â”€ controllers/
    â”‚   â”œâ”€â”€ AuthController.ts
    â”‚   â”œâ”€â”€ EventController.ts
    â”‚   â”œâ”€â”€ PlaceController.ts
    â”‚   â”œâ”€â”€ UserController.ts
    â”‚   â””â”€â”€ VisitedController.ts
    â”‚
    â”œâ”€â”€ DTO/
    â”‚   â”œâ”€â”€ wrappers/
    â”‚   â”‚   â”œâ”€â”€ AddressDTO.ts
    â”‚   â”‚   â””â”€â”€ LoginInfoDTO.ts
    â”‚   â”œâ”€â”€ BookingDTO.ts
    â”‚   â”œâ”€â”€ EventDTO.ts
    â”‚   â”œâ”€â”€ PlaceDTO.ts
    â”‚   â”œâ”€â”€ UserDTO.ts
    â”‚   â””â”€â”€ VisitedDTO.ts
    â”‚
    â”œâ”€â”€ error/
    â”‚   â”œâ”€â”€ ErrorsHandler.ts
    â”‚   â””â”€â”€ HttpException.ts
    â”‚
    â”œâ”€â”€ middleware/
    â”‚   â”œâ”€â”€ ErrorsHandler.ts
    â”‚   â”œâ”€â”€ JwtRequired.ts
    â”‚   â”œâ”€â”€ RoleCheck.ts
    â”‚   â””â”€â”€ ValidateId.ts
    â”‚
    â”œâ”€â”€ migrations/
    â”‚   â”œâ”€â”€ 1747755304546-GeneratedMigration.ts
    â”‚   â””â”€â”€ 1747865261580-GeneratedMigration.ts
    â”‚
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ enum/
    â”‚   â”‚   â”œâ”€â”€ PlaceType.ts
    â”‚   â”‚   â””â”€â”€ UserRole.ts
    â”‚   â”œâ”€â”€ wrappers/
    â”‚   â”‚   â”œâ”€â”€ Address.ts
    â”‚   â”‚   â””â”€â”€ LoginInfo.ts
    â”‚   â”œâ”€â”€ Event.ts
    â”‚   â”œâ”€â”€ Place.ts
    â”‚   â”œâ”€â”€ User.ts
    â”‚   â””â”€â”€ VisitedPlaces.ts
    â”‚
    â”œâ”€â”€ repositories/
    â”‚   â”œâ”€â”€ EventRepository.ts
    â”‚   â”œâ”€â”€ PlaceRepository.ts
    â”‚   â”œâ”€â”€ UserRepository.ts
    â”‚   â””â”€â”€ VisitedRepository.ts
    â”‚
    â”œâ”€â”€ routes/
    â”‚   â”œâ”€â”€ AuthRoutes.ts
    â”‚   â”œâ”€â”€ EventRoutes.ts
    â”‚   â”œâ”€â”€ PlaceRoutes.ts
    â”‚   â”œâ”€â”€ UserRoutes.ts
    â”‚   â””â”€â”€ VisitedRoutes.ts
    â”‚
    â”œâ”€â”€ service/
    â”‚   â”œâ”€â”€ AuthService.ts
    â”‚   â”œâ”€â”€ EventService.ts
    â”‚   â”œâ”€â”€ PlaceService.ts
    â”‚   â”œâ”€â”€ UserService.ts
    â”‚   â””â”€â”€ VisitedService.ts
    â”‚
    â”œâ”€â”€ utils/
    â”‚   â”œâ”€â”€ ExistsValidator.ts
    â”‚   â”œâ”€â”€ TokenManager.ts
    â”‚   â””â”€â”€ ValidateRequestBody.ts
    â”‚
    â”œâ”€â”€ db_config/
    â”‚   â””â”€â”€ AppDataSource.ts
    â”‚
    â””â”€â”€ @types/
        â””â”€â”€ express
            â””â”€â”€ index.d.ts
</code></pre>
            <p>Para uma exploraÃ§Ã£o mais detalhada, navegue pelo <a href="https://github.com/vyctor-carvalho/Trace_Point" target="_blank" rel="noopener noreferrer">repositÃ³rio no GitHub</a>.</p>
        </section>

        <footer>
            Trace Point API &copy; 2025. Feito com â¤ï¸ em BelÃ©m.
            <p><a href="https://github.com/vyctor-carvalho/Trace_Point" target="_blank" rel="noopener noreferrer">Ver Projeto no GitHub</a></p>
        </footer>
    </div>
</body>
</html>